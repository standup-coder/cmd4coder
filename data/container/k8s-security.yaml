category: "Kubernetes Security"
description: "Security scanning and compliance tools for Kubernetes"
commands:
  - name: "trivy image"
    description: "Scan container image for vulnerabilities"
    category: "Kubernetes Security"
    platforms:
      - "linux"
      - "darwin"
      - "windows"
    usage:
      - "trivy image [image-name] [flags]"
    options:
      - flag: "--severity"
        description: "Filter by severity: CRITICAL,HIGH,MEDIUM,LOW"
      - flag: "--format"
        description: "Output format: table, json, sarif"
      - flag: "--exit-code"
        description: "Exit with code 1 if vulnerabilities found"
    examples:
      - command: "trivy image nginx:latest"
        description: "Scan nginx image for vulnerabilities"
      - command: "trivy image --severity HIGH,CRITICAL nginx:latest"
        description: "Scan for high and critical vulnerabilities only"
      - command: "trivy image --format json nginx:latest"
        description: "Output scan results in JSON format"
      - command: "trivy image --exit-code 1 myapp:v1.0"
        description: "Scan and fail if vulnerabilities found"
    risks:
      - level: "low"
        description: "Read-only scanning; no modifications to images"
    install_method: "Download from https://aquasecurity.github.io/trivy/"
    version_check: "trivy --version"

  - name: "trivy fs"
    description: "Scan filesystem for vulnerabilities and misconfigurations"
    category: "Kubernetes Security"
    platforms:
      - "linux"
      - "darwin"
      - "windows"
    usage:
      - "trivy fs [path] [flags]"
    options:
      - flag: "--security-checks"
        description: "Security checks: vuln, config, secret"
      - flag: "--severity"
        description: "Filter by severity"
    examples:
      - command: "trivy fs ."
        description: "Scan current directory"
      - command: "trivy fs --security-checks vuln,config /path/to/project"
        description: "Scan for vulnerabilities and misconfigurations"
      - command: "trivy fs --severity CRITICAL /app"
        description: "Scan for critical issues only"
    risks:
      - level: "low"
        description: "Read-only scanning; no file modifications"
    install_method: "Download from https://aquasecurity.github.io/trivy/"
    version_check: "trivy --version"

  - name: "trivy k8s"
    description: "Scan Kubernetes cluster for security issues"
    category: "Kubernetes Security"
    platforms:
      - "linux"
      - "darwin"
      - "windows"
    usage:
      - "trivy k8s [flags]"
    options:
      - flag: "--namespace"
        description: "Scan specific namespace"
      - flag: "--report"
        description: "Report type: summary, all"
    examples:
      - command: "trivy k8s --report summary"
        description: "Scan entire cluster with summary"
      - command: "trivy k8s --namespace production"
        description: "Scan production namespace"
      - command: "trivy k8s all -n default"
        description: "Scan all resources in default namespace"
    risks:
      - level: "low"
        description: "Read-only scanning; queries cluster via kubectl"
    install_method: "Download from https://aquasecurity.github.io/trivy/"
    version_check: "trivy --version"

  - name: "trivy config"
    description: "Scan configuration files for misconfigurations"
    category: "Kubernetes Security"
    platforms:
      - "linux"
      - "darwin"
      - "windows"
    usage:
      - "trivy config [path] [flags]"
    options:
      - flag: "--format"
        description: "Output format: table, json"
    examples:
      - command: "trivy config deployment.yaml"
        description: "Scan Kubernetes manifest"
      - command: "trivy config manifests/"
        description: "Scan directory of manifests"
      - command: "trivy config --format json helm-chart/"
        description: "Scan Helm chart with JSON output"
    risks:
      - level: "low"
        description: "Read-only scanning; no file modifications"
    install_method: "Download from https://aquasecurity.github.io/trivy/"
    version_check: "trivy --version"

  - name: "kube-bench run"
    description: "Run CIS Kubernetes security benchmark checks"
    category: "Kubernetes Security"
    platforms:
      - "linux"
    usage:
      - "kube-bench run [flags]"
    options:
      - flag: "--targets"
        description: "Target components: master, node, etcd, policies"
      - flag: "--json"
        description: "Output results in JSON format"
      - flag: "--config"
        description: "Configuration file path"
    examples:
      - command: "kube-bench run"
        description: "Run all security checks"
      - command: "kube-bench run --targets master"
        description: "Check control plane security only"
      - command: "kube-bench run --targets node"
        description: "Check worker node security only"
      - command: "kube-bench run --json"
        description: "Output results in JSON format"
    risks:
      - level: "low"
        description: "Read-only assessment; checks configuration only"
    install_method: "Download from https://github.com/aquasecurity/kube-bench/releases"
    version_check: "kube-bench version"

  - name: "systemctl status falco"
    description: "Check Falco runtime security service status"
    category: "Kubernetes Security"
    platforms:
      - "linux"
    usage:
      - "systemctl status falco"
    examples:
      - command: "systemctl status falco"
        description: "View Falco service status"
      - command: "systemctl start falco"
        description: "Start Falco service"
      - command: "systemctl restart falco"
        description: "Restart Falco service"
      - command: "journalctl -u falco -f"
        description: "Follow Falco security event logs"
    risks:
      - level: "low"
        description: "Read-only status check; no operational changes"
      - level: "medium"
        description: "Restarting Falco causes brief monitoring gap"
    install_method: "Install from https://falco.org/docs/getting-started/installation/"
    version_check: "falco --version"

  - name: "falco"
    description: "Start Falco runtime security monitoring"
    category: "Kubernetes Security"
    platforms:
      - "linux"
    usage:
      - "falco [flags]"
    options:
      - flag: "-c"
        description: "Configuration file path"
      - flag: "-r"
        description: "Rules file path"
      - flag: "-M"
        description: "Run for this many seconds then exit"
    examples:
      - command: "falco -c /etc/falco/falco.yaml"
        description: "Start Falco with config file"
      - command: "falco -r /etc/falco/rules/custom-rules.yaml"
        description: "Load custom security rules"
      - command: "falco -M 60"
        description: "Run Falco for 60 seconds"
    risks:
      - level: "low"
        description: "Monitoring only; detects security events without blocking"
    install_method: "Install from https://falco.org/docs/getting-started/installation/"
    version_check: "falco --version"